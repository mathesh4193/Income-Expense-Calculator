<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Income Expense Calculator</title>

<!-- Chart & Excel -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:Segoe UI,Tahoma}
body{background:#f4f7fc;display:flex;flex-direction:column;min-height:100vh}
header,footer{background:#003366;color:#fff;text-align:center;padding:1rem}
main{flex:1;display:flex;justify-content:center;padding:1rem}

.calculator{background:#fff;max-width:650px;width:100%;padding:1.5rem;border-radius:10px;box-shadow:0 10px 20px rgba(0,0,0,.1)}
h2{text-align:center;color:#003366;margin-bottom:1rem}

.summary{display:flex;gap:1rem;flex-wrap:wrap;margin-bottom:1rem}
.summary-item{flex:1;background:#e8f0fe;padding:1rem;border-radius:8px;text-align:center}
.income{color:#2e7d32}
.expense{color:#c62828}
.net{color:#1565c0}

form{display:flex;gap:1rem;flex-wrap:wrap;margin-bottom:1rem}
input,select,button{padding:.7rem;border-radius:6px;border:1px solid #ccc}
button{background:#003366;color:#fff;border:none;cursor:pointer}
button:hover{opacity:.9}
#resetBtn{background:#c62828}

.filters{display:flex;justify-content:center;gap:1.5rem;margin-bottom:1rem}

ul{list-style:none;max-height:250px;overflow-y:auto}
li{display:flex;justify-content:space-between;padding:.7rem;border-bottom:1px solid #eee}

@media(max-width:600px){
.summary{flex-direction:column}
form{flex-direction:column}
li{flex-direction:column;gap:.5rem}
}
</style>
</head>

<body>

<header>
<h1>Finance Tracker</h1>
</header>

<main>
<div class="calculator">

<h2>Income Expense Calculator</h2>

<div class="summary">
  <div class="summary-item">
    <p>Total Income</p>
    <h3 id="totalIncome" class="income">RS.0.00</h3>
  </div>
  <div class="summary-item">
    <p>Total Expense</p>
    <h3 id="totalExpense" class="expense">RS.0.00</h3>
  </div>
  <div class="summary-item">
    <p>Net Balance</p>
    <h3 id="netBalance" class="net">RS.0.00</h3>
  </div>
</div>

<form id="entryForm">
<input id="description" placeholder="Description" required>
<input id="amount" type="number" step="0.01" required>
<select id="type">
<option value="income">Income</option>
<option value="expense">Expense</option>
</select>
<button type="submit">Add</button>
<button type="button" id="resetBtn">Reset</button>
</form>

<div class="filters">
<label><input type="radio" name="filter" value="all" checked> All</label>
<label><input type="radio" name="filter" value="income"> Income</label>
<label><input type="radio" name="filter" value="expense"> Expense</label>
</div>

<div style="text-align:center;margin-bottom:1rem">
<button onclick="exportToExcel()" style="background:#2e7d32">Export to Excel</button>
</div>

<ul id="entryList"></ul>

<canvas id="dailyChart" style="margin-top:25px"></canvas>

</div>
</main>

<footer>
© 2025 Finance Tracker
</footer>

<script>
const form=document.getElementById("entryForm");
const entryList=document.getElementById("entryList");
const totalIncome=document.getElementById("totalIncome");
const totalExpense=document.getElementById("totalExpense");
const netBalance=document.getElementById("netBalance");
const resetBtn=document.getElementById("resetBtn");
const filterRadios=document.querySelectorAll("input[name=filter]");

let entries=JSON.parse(localStorage.getItem("entries"))||[];
let chart;

function save(){localStorage.setItem("entries",JSON.stringify(entries))}

function render(filter="all"){
entryList.innerHTML="";
entries.filter(e=>filter==="all"||e.type===filter)
.forEach(e=>{
const li=document.createElement("li");
li.innerHTML=`
<strong>${e.description}</strong>
<span>${e.type==="income"?"+":"-"}RS.${e.amount}</span>
<small>${e.date}</small>
<button onclick="del(${e.id})">❌</button>`;
entryList.appendChild(li);
});
updateSummary();
renderChart();
}

function updateSummary(){
let inc=0,exp=0;
entries.forEach(e=>e.type==="income"?inc+=e.amount:exp+=e.amount);
totalIncome.textContent="RS."+inc.toFixed(2);
totalExpense.textContent="RS."+exp.toFixed(2);
netBalance.textContent="RS."+(inc-exp).toFixed(2);
}

form.onsubmit=e=>{
e.preventDefault();
entries.push({
id:Date.now(),
description:description.value,
amount:+amount.value,
type:type.value,
date:new Date().toLocaleDateString()
});
save();form.reset();render(getFilter());
};

function del(id){
entries=entries.filter(e=>e.id!==id);
save();render(getFilter());
}

resetBtn.onclick=()=>{
if(confirm("Reset all?")){
entries=[];save();render();
}
};

filterRadios.forEach(r=>r.onchange=()=>render(getFilter()));
function getFilter(){return document.querySelector("input[name=filter]:checked").value}

function renderChart(){
const daily={};
entries.forEach(e=>{
daily[e.date]??={income:0,expense:0};
daily[e.date][e.type]+=e.amount;
});
const labels=Object.keys(daily);
const income=labels.map(d=>daily[d].income);
const expense=labels.map(d=>daily[d].expense);

const ctx=document.getElementById("dailyChart");
if(chart)chart.destroy();
chart=new Chart(ctx,{
type:"bar",
data:{labels,datasets:[
{label:"Income",data:income},
{label:"Expense",data:expense}
]},
options:{responsive:true}
});
}

function exportToExcel(){
const data=entries.map(e=>({
Date:e.date,Description:e.description,Type:e.type,Amount:e.amount
}));
const ws=XLSX.utils.json_to_sheet(data);
const wb=XLSX.utils.book_new();
XLSX.utils.book_append_sheet(wb,ws,"Report");
XLSX.writeFile(wb,"Income_Expense.xlsx");
}

render();
</script>

</body>
</html>